<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JVMå†…å­˜æ¨¡å‹è¯¦è§£</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <script src="../i18n.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .back-btn {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            text-decoration: none;
            margin-bottom: 20px;
            transition: background 0.3s;
        }

        .back-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .control-panel {
            text-align: center;
            margin-bottom: 30px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            border-radius: 25px;
            cursor: pointer;
            margin: 0 10px;
            transition: transform 0.3s;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .memory-layout {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            margin-bottom: 30px;
        }

        .memory-container {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-top: 20px;
        }

        /* å·¦ä¾§å†…å­˜åŒºåŸŸåˆ—è¡¨ */
        .memory-areas {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .memory-area {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 15px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid transparent;
        }

        .memory-area:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .memory-area.active {
            border-color: #ffd700;
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.5);
        }

        .memory-area h3 {
            font-size: 1.3em;
            margin-bottom: 8px;
        }

        .memory-area p {
            font-size: 0.9em;
            opacity: 0.9;
        }

        /* å³ä¾§è¯¦ç»†å±•ç¤ºåŒº */
        .detail-view {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            min-height: 400px;
        }

        .detail-content {
            display: none;
        }

        .detail-content.active {
            display: block;
        }

        .detail-title {
            font-size: 2em;
            color: #333;
            margin-bottom: 20px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        /* å¯¹è±¡å†…å­˜åˆ†é…æ¼”ç¤º */
        .object-demo {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .object-header {
            background: #667eea;
            color: white;
            padding: 10px 15px;
            border-radius: 8px 8px 0 0;
            font-weight: bold;
            margin: -20px -20px 15px -20px;
        }

        .object-field {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }

        .field-name {
            color: #667eea;
            font-weight: bold;
        }

        .field-value {
            color: #666;
        }

        /* æ ˆå¸§å¯è§†åŒ– */
        .stack-frame {
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            position: relative;
        }

        .stack-frame::before {
            content: '';
            position: absolute;
            left: -2px;
            top: 0;
            width: 5px;
            height: 100%;
            background: #667eea;
            border-radius: 10px 0 0 10px;
        }

        .frame-title {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .frame-section {
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }

        .section-label {
            font-size: 0.85em;
            color: #888;
            margin-bottom: 5px;
        }

        /* æ–¹æ³•åŒºå†…å®¹ */
        .class-info {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid #764ba2;
        }

        .class-name {
            font-weight: bold;
            color: #764ba2;
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .class-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .detail-item {
            padding: 8px;
            background: #f8f9fa;
            border-radius: 5px;
            font-size: 0.9em;
        }

        /* ä»£ç ç¤ºä¾‹ */
        .code-example {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            line-height: 1.4;
            white-space: pre;
            text-align: left;
            overflow-x: auto;
            tab-size: 4;
            position: relative;
        }
        .code-example::before {
            content: 'BYTECODE';
            position: absolute;
            top: 5px;
            right: 10px;
            font-size: 0.75em;
            color: #6272a4;
            font-weight: bold;
        }

        .code-line {
            line-height: 1.4;
        }

        .keyword { color: #ff79c6; }
        .type { color: #8be9fd; }
        .method { color: #50fa7b; }
        .string { color: #f1fa8c; }
        .comment { color: #6272a4; }

        /* å†…å­˜åˆ†é…åŠ¨ç”» */
        .allocation-animation {
            display: flex;
            align-items: center;
            justify-content: space-around;
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 10px;
        }

        .allocation-step {
            text-align: center;
            padding: 15px;
        }

        .allocation-box {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin: 0 auto 10px auto;
        }

        .arrow-right {
            font-size: 2em;
            color: #667eea;
        }

        /* å†…å­˜å¸ƒå±€å›¾ */
        .memory-diagram {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .memory-region {
            border: 2px solid #667eea;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            position: relative;
        }

        .region-label {
            position: absolute;
            top: -12px;
            left: 15px;
            background: white;
            padding: 0 10px;
            color: #667eea;
            font-weight: bold;
        }

        .region-content {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 8px;
            margin-top: 10px;
        }

        .memory-cell {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-size: 0.85em;
            border: 1px solid #ddd;
        }

        .memory-cell.allocated {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        @media (max-width: 768px) {
            .memory-container {
                grid-template-columns: 1fr;
            }
        }
    
        /* è¨€èªåˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .language-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        #language-selector {
            padding: 10px 15px;
            border-radius: 25px;
            border: 2px solid white;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 1em;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
            font-weight: bold;
        }

        #language-selector:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        #language-selector option {
            background: #764ba2;
            color: white;
        }
    
        /* Prism.js code block styling */
        pre {
            background: #2d2d2d;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            overflow-x: auto;
        }

        pre code {
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            line-height: 1.8;
            text-align: left;
        }
</style>

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@5/github-markdown.min.css">

    <!-- Prism.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-java.min.js"></script>
</head>
<body>
    <!-- è¨€èªåˆ‡ã‚Šæ›¿ãˆ -->
    <div class="language-switcher">
        <select id="language-selector" onchange="window.langSwitcher.changeLanguage(this.value)">
            <option value="zh">ä¸­æ–‡</option>
            <option value="ja">æ—¥æœ¬èª</option>
            <option value="en">English</option>
        </select></div>


    <div class="container">
        <a href="../index.html" class="back-btn animate__animated animate__fadeIn">â† è¿”å›ä¸»é¡µ</a>

        <div class="header animate__animated animate__fadeInDown">
            <h1>ğŸ§  <span data-i18n="jvmMemoryTitle">JVMå†…å­˜æ¨¡å‹è¯¦è§£</span></h1>
            <p>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºçš„å†…å­˜ç»“æ„ä¸åˆ†é…æœºåˆ¶</p></div>

        <div class="control-panel animate__animated animate__fadeIn">
            <button class="btn" onclick="startDemo()">â–¶ï¸ å¼€å§‹æ¼”ç¤º</button>
            <button class="btn" onclick="resetDemo()">ğŸ”„ é‡ç½®</button></div>

        <div class="memory-layout animate__animated animate__fadeInUp">
            <div class="memory-container">
                <!-- å·¦ä¾§å†…å­˜åŒºåŸŸåˆ—è¡¨ -->
                <div class="memory-areas">
                    <div class="memory-area" data-area="heap" onclick="showDetail('heap')">
                        <h3>ğŸ—‚ï¸ å †å†…å­˜ (Heap)</h3>
                        <p>å­˜å‚¨æ‰€æœ‰å¯¹è±¡å®ä¾‹å’Œæ•°ç»„</p></div>

                    <div class="memory-area" data-area="stack" onclick="showDetail('stack')">
                        <h3>ğŸ“‹ è™šæ‹Ÿæœºæ ˆ (VM Stack)</h3>
                        <p>å­˜å‚¨å±€éƒ¨å˜é‡ã€æ–¹æ³•è°ƒç”¨</p></div>

                    <div class="memory-area" data-area="method" onclick="showDetail('method')">
                        <h3>ğŸ“š æ–¹æ³•åŒº (Method Area)</h3>
                        <p>å­˜å‚¨ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡</p></div>

                    <div class="memory-area" data-area="pc" onclick="showDetail('pc')">
                        <h3>ğŸ§® ç¨‹åºè®¡æ•°å™¨ (PC Register)</h3>
                        <p>è®°å½•å½“å‰æ‰§è¡Œå­—èŠ‚ç æŒ‡ä»¤åœ°å€</p></div>

                    <div class="memory-area" data-area="native" onclick="showDetail('native')">
                        <h3>ğŸ”§ æœ¬åœ°æ–¹æ³•æ ˆ (Native Stack)</h3>
                        <p>æ”¯æŒNativeæ–¹æ³•æ‰§è¡Œ</p></div>
                </div>

                <!-- å³ä¾§è¯¦ç»†å±•ç¤ºåŒº -->
                <div class="detail-view">
                    <!-- å †å†…å­˜è¯¦æƒ… -->
                    <div class="detail-content" id="heap-detail">
                        <h2 class="detail-title">å †å†…å­˜ (Heap Memory)</h2>

                        <div class="code-example">
<span class="code-line"><span class="keyword">class</span> <span class="type">Person</span> {</span>
<span class="code-line">    <span class="type">String</span> name;</span>
<span class="code-line">    <span class="type">int</span> age;</span>
<span class="code-line">}</span>
<span class="code-line"></span>
<span class="code-line"><span class="type">Person</span> p = <span class="keyword">new</span> <span class="type">Person</span>(); <span class="comment">// å¯¹è±¡åœ¨å †ä¸­åˆ†é…</span></span></div>

                        <div class="allocation-animation">
                            <div class="allocation-step">
                                <div class="allocation-box">new</div>
                                <p>åˆ›å»ºå¯¹è±¡</p></div>
                            <div class="arrow-right">â†’</div>
                            <div class="allocation-step">
                                <div class="allocation-box">å †</div>
                                <p>åˆ†é…å†…å­˜</p></div>
                            <div class="arrow-right">â†’</div>
                            <div class="allocation-step">
                                <div class="allocation-box">ref</div>
                                <p>è¿”å›å¼•ç”¨</p></div></div>

                        <div class="object-demo">
                            <div class="object-header">Personå¯¹è±¡ @ 0x7f5a6b8c</div>
                            <div class="object-field">
                                <span class="field-name">Mark Word</span>
                                <span class="field-value">hashCode, GCå¹´é¾„, é”æ ‡å¿—</span></div>
                            <div class="object-field">
                                <span class="field-name">Class Pointer</span>
                                <span class="field-value">â†’ Person.class</span></div>
                            <div class="object-field">
                                <span class="field-name">name</span>
                                <span class="field-value">"å¼ ä¸‰"</span></div>
                            <div class="object-field">
                                <span class="field-name">age</span>
                                <span class="field-value">25</span></div></div>

                        <div class="memory-diagram">
                            <h3 style="margin-bottom: 15px;">å †å†…å­˜åˆ†ä»£ç»“æ„</h3>
                            <div class="memory-region">
                                <span class="region-label">æ–°ç”Ÿä»£ (Young Generation) 1/3</span>
                                <div class="region-content">
                                    <div class="memory-cell">Eden</div>
                                    <div class="memory-cell">Eden</div>
                                    <div class="memory-cell">Eden</div>
                                    <div class="memory-cell">S0</div>
                                    <div class="memory-cell">S1</div></div></div>
                            <div class="memory-region">
                                <span class="region-label">è€å¹´ä»£ (Old Generation) 2/3</span>
                                <div class="region-content">
                                    <div class="memory-cell">Old</div>
                                    <div class="memory-cell">Old</div>
                                    <div class="memory-cell">Old</div>
                                    <div class="memory-cell">Old</div></div></div></div>
                    </div>

                    <!-- è™šæ‹Ÿæœºæ ˆè¯¦æƒ… -->
                    <div class="detail-content" id="stack-detail">
                        <h2 class="detail-title">è™šæ‹Ÿæœºæ ˆ (VM Stack)</h2>

                        <div class="code-example">
<span class="code-line"><span class="keyword">public void</span> <span class="method">method1</span>() {</span>
<span class="code-line">    <span class="type">int</span> a = 10;</span>
<span class="code-line">    <span class="method">method2</span>(a);</span>
<span class="code-line">}</span>
<span class="code-line"></span>
<span class="code-line"><span class="keyword">public void</span> <span class="method">method2</span>(<span class="type">int</span> x) {</span>
<span class="code-line">    <span class="type">int</span> y = x * 2;</span>
<span class="code-line">}</span></div>

                        <div style="margin-top: 20px;">
                            <div class="stack-frame animate__animated animate__slideInUp">
                                <div class="frame-title">æ ˆå¸§: method2(int)</div>
                                <div class="frame-section">
                                    <div class="section-label">å±€éƒ¨å˜é‡è¡¨</div>
                                    <div class="object-field">
                                        <span class="field-name">x</span>
                                        <span class="field-value">10</span></div>
                                    <div class="object-field">
                                        <span class="field-name">y</span>
                                        <span class="field-value">20</span></div></div>
                                <div class="frame-section">
                                    <div class="section-label">æ“ä½œæ•°æ ˆ</div>
                                    <div style="display: flex; gap: 5px;">
                                        <div class="memory-cell allocated">20</div>
                                        <div class="memory-cell allocated">10</div></div></div>
                                <div class="frame-section">
                                    <div class="section-label">åŠ¨æ€é“¾æ¥</div>
                                    <div class="field-value">â†’ æ–¹æ³•åŒºä¸­çš„method2ç¬¦å·å¼•ç”¨</div></div>
                                <div class="frame-section">
                                    <div class="section-label">è¿”å›åœ°å€</div>
                                    <div class="field-value">0x45f8 (method1çš„è°ƒç”¨ä½ç½®)</div></div></div>

                            <div class="stack-frame animate__animated animate__slideInUp" style="animation-delay: 0.2s;">
                                <div class="frame-title">æ ˆå¸§: method1()</div>
                                <div class="frame-section">
                                    <div class="section-label">å±€éƒ¨å˜é‡è¡¨</div>
                                    <div class="object-field">
                                        <span class="field-name">a</span>
                                        <span class="field-value">10</span></div></div>
                                <div class="frame-section">
                                    <div class="section-label">æ“ä½œæ•°æ ˆ</div>
                                    <div style="display: flex; gap: 5px;">
                                        <div class="memory-cell">ç©º</div></div></div></div></div>

                        <div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 10px;">
                            <strong>ğŸ’¡ æ³¨æ„ï¼š</strong> æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ç‹¬ç«‹çš„è™šæ‹Ÿæœºæ ˆï¼Œçº¿ç¨‹ç§æœ‰ã€‚æ ˆå¸§éšæ–¹æ³•è°ƒç”¨è€Œåˆ›å»ºï¼Œéšæ–¹æ³•ç»“æŸè€Œé”€æ¯ã€‚</div>
                    </div>

                    <!-- æ–¹æ³•åŒºè¯¦æƒ… -->
                    <div class="detail-content" id="method-detail">
                        <h2 class="detail-title">æ–¹æ³•åŒº (Method Area)</h2>

                        <p style="margin-bottom: 20px; color: #666;">
                            æ–¹æ³•åŒºæ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸï¼Œç”¨äºå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ç­‰æ•°æ®ã€‚
                        </p>

                        <div class="class-info">
                            <div class="class-name">class Person</div>
                            <div class="class-details">
                                <div class="detail-item">
                                    <strong>ç±»å‹ä¿¡æ¯</strong><br>
                                    ä¿®é¥°ç¬¦: public<br>
                                    çˆ¶ç±»: Object<br>
                                    æ¥å£: [ ]</div>
                                <div class="detail-item">
                                    <strong>å­—æ®µä¿¡æ¯</strong><br>
                                    name: String<br>
                                    age: int</div>
                                <div class="detail-item">
                                    <strong>æ–¹æ³•ä¿¡æ¯</strong><br>
                                    getName(): String<br>
                                    setName(String): void</div>
                                <div class="detail-item">
                                    <strong>å¸¸é‡æ± </strong><br>
                                    #1: Class Person<br>
                                    #2: String "name"<br>
                                    #3: String "age"</div></div></div>

                        <div class="code-example">
<span class="code-line"><span class="keyword">public class</span> <span class="type">StaticDemo</span> {</span>
<span class="code-line">    <span class="keyword">static</span> <span class="type">int</span> count = 0; <span class="comment">// å­˜å‚¨åœ¨æ–¹æ³•åŒº</span></span>
<span class="code-line">    <span class="keyword">static final</span> <span class="type">String</span> NAME = <span class="string">"Java"</span>; <span class="comment">// å¸¸é‡æ± </span></span>
<span class="code-line">}</span></div>

                        <div class="memory-diagram">
                            <h3 style="margin-bottom: 15px;">æ–¹æ³•åŒºå†…å®¹ç»“æ„</h3>
                            <div class="memory-region">
                                <span class="region-label">è¿è¡Œæ—¶å¸¸é‡æ± </span>
                                <div class="region-content">
                                    <div class="memory-cell allocated">"Java"</div>
                                    <div class="memory-cell allocated">"Hello"</div>
                                    <div class="memory-cell allocated">100</div></div></div>
                            <div class="memory-region">
                                <span class="region-label">é™æ€å˜é‡</span>
                                <div class="region-content">
                                    <div class="memory-cell allocated">count=0</div></div></div>
                            <div class="memory-region">
                                <span class="region-label">ç±»å…ƒæ•°æ®</span>
                                <div class="region-content">
                                    <div class="memory-cell allocated">Person</div>
                                    <div class="memory-cell allocated">Student</div></div></div></div>

                        <div style="margin-top: 20px; padding: 15px; background: #d1ecf1; border-radius: 10px;">
                            <strong>ğŸ“Œ JDK 8+ï¼š</strong> æ–¹æ³•åŒºçš„å®ç°ä»æ°¸ä¹…ä»£(PermGen)æ”¹ä¸ºå…ƒç©ºé—´(Metaspace)ï¼Œä½¿ç”¨æœ¬åœ°å†…å­˜è€Œéå †å†…å­˜ã€‚</div>
                    </div>

                    <!-- ç¨‹åºè®¡æ•°å™¨è¯¦æƒ… -->
                    <div class="detail-content" id="pc-detail">
                        <h2 class="detail-title">ç¨‹åºè®¡æ•°å™¨ (Program Counter Register)</h2>

                        <p style="margin-bottom: 20px; color: #666;">
                            ç¨‹åºè®¡æ•°å™¨æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´,å¯ä»¥çœ‹ä½œæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ã€‚
                        </p>

                        <div class="code-example">
<span class="code-line">0: iconst_1      <span class="comment">// å°†å¸¸é‡1å‹å…¥æ“ä½œæ•°æ ˆ</span></span>
<span class="code-line">1: istore_1      <span class="comment">// å¼¹å‡ºæ ˆé¡¶å…ƒç´ ,å­˜å…¥å±€éƒ¨å˜é‡1</span></span>
<span class="code-line">2: iconst_2      <span class="comment">// å°†å¸¸é‡2å‹å…¥æ“ä½œæ•°æ ˆ</span></span>
<span class="code-line">3: istore_2      <span class="comment">// å¼¹å‡ºæ ˆé¡¶å…ƒç´ ,å­˜å…¥å±€éƒ¨å˜é‡2</span></span>
<span class="code-line" style="background: #ff79c644;">4: iload_1       <span class="comment">// â† å½“å‰PCæŒ‡å‘è¿™é‡Œ</span></span>
<span class="code-line">5: iload_2</span>
<span class="code-line">6: iadd          <span class="comment">// æ‰§è¡ŒåŠ æ³•</span></span>
<span class="code-line">7: istore_3</span>
<span class="code-line">8: return</span></div>

                        <div class="object-demo">
                            <div class="object-header">ç¨‹åºè®¡æ•°å™¨çŠ¶æ€</div>
                            <div class="object-field">
                                <span class="field-name">å½“å‰æŒ‡ä»¤åœ°å€</span>
                                <span class="field-value">0x0004</span></div>
                            <div class="object-field">
                                <span class="field-name">å½“å‰æŒ‡ä»¤</span>
                                <span class="field-value">iload_1</span></div>
                            <div class="object-field">
                                <span class="field-name">ä¸‹ä¸€æ¡æŒ‡ä»¤</span>
                                <span class="field-value">0x0005 (iload_2)</span></div></div>

                        <div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 10px;">
                            <strong>ğŸ’¡ ç‰¹ç‚¹ï¼š</strong>
                            <ul style="margin-top: 10px; padding-left: 20px;">
                                <li>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨</li>
                                <li>çº¿ç¨‹ç§æœ‰,äº’ä¸å½±å“</li>
                                <li>å”¯ä¸€ä¸ä¼šå‡ºç°OutOfMemoryErrorçš„åŒºåŸŸ</li>
                                <li>å¦‚æœæ‰§è¡Œçš„æ˜¯Nativeæ–¹æ³•,è®¡æ•°å™¨å€¼ä¸ºç©º(Undefined)</li>
                            </ul></div>
                    </div>

                    <!-- æœ¬åœ°æ–¹æ³•æ ˆè¯¦æƒ… -->
                    <div class="detail-content" id="native-detail">
                        <h2 class="detail-title">æœ¬åœ°æ–¹æ³•æ ˆ (Native Method Stack)</h2>

                        <p style="margin-bottom: 20px; color: #666;">
                            æœ¬åœ°æ–¹æ³•æ ˆä¸ºè™šæ‹Ÿæœºä½¿ç”¨åˆ°çš„Nativeæ–¹æ³•æœåŠ¡,ä¸è™šæ‹Ÿæœºæ ˆç±»ä¼¼,åªæ˜¯æœåŠ¡å¯¹è±¡ä¸åŒã€‚
                        </p>

                        <div class="code-example">
<span class="code-line"><span class="keyword">public class</span> <span class="type">NativeDemo</span> {</span>
<span class="code-line">    <span class="comment">// å£°æ˜æœ¬åœ°æ–¹æ³•</span></span>
<span class="code-line">    <span class="keyword">public native void</span> <span class="method">nativeMethod</span>();</span>
<span class="code-line">    </span>
<span class="code-line">    <span class="keyword">static</span> {</span>
<span class="code-line">        System.<span class="method">loadLibrary</span>(<span class="string">"native-lib"</span>);</span>
<span class="code-line">    }</span>
<span class="code-line">}</span></div>

                        <div class="allocation-animation">
                            <div class="allocation-step">
                                <div class="allocation-box">Java</div>
                                <p>Javaæ–¹æ³•è°ƒç”¨</p></div>
                            <div class="arrow-right">â†’</div>
                            <div class="allocation-step">
                                <div class="allocation-box">JNI</div>
                                <p>JNIæ¥å£</p></div>
                            <div class="arrow-right">â†’</div>
                            <div class="allocation-step">
                                <div class="allocation-box">C/C++</div>
                                <p>æœ¬åœ°æ–¹æ³•</p></div></div>

                        <div class="class-info">
                            <div class="class-name">å¸¸è§çš„æœ¬åœ°æ–¹æ³•ç¤ºä¾‹</div>
                            <div class="class-details">
                                <div class="detail-item">
                                    <strong>Objectç±»</strong><br>
                                    hashCode()<br>
                                    clone()<br>
                                    notify()</div>
                                <div class="detail-item">
                                    <strong>Threadç±»</strong><br>
                                    start()<br>
                                    sleep()<br>
                                    currentThread()</div>
                                <div class="detail-item">
                                    <strong>Systemç±»</strong><br>
                                    currentTimeMillis()<br>
                                    arraycopy()<br>
                                    identityHashCode()</div>
                                <div class="detail-item">
                                    <strong>FileInputStream</strong><br>
                                    open()<br>
                                    read()<br>
                                    close()</div></div></div>

                        <div style="margin-top: 20px; padding: 15px; background: #d1ecf1; border-radius: 10px;">
                            <strong>ğŸ“Œ æ³¨æ„ï¼š</strong>
                            <ul style="margin-top: 10px; padding-left: 20px;">
                                <li>HotSpotè™šæ‹Ÿæœºå°†æœ¬åœ°æ–¹æ³•æ ˆå’Œè™šæ‹Ÿæœºæ ˆåˆäºŒä¸ºä¸€</li>
                                <li>å¯èƒ½æŠ›å‡ºStackOverflowErrorå’ŒOutOfMemoryError</li>
                                <li>é€šè¿‡JNI (Java Native Interface) è°ƒç”¨æœ¬åœ°æ–¹æ³•</li>
                            </ul></div>
                    </div>

                    <!-- é»˜è®¤æ˜¾ç¤º -->
                    <div class="detail-content active" id="default-detail">
                        <h2 class="detail-title">JVMå†…å­˜æ¨¡å‹æ¦‚è§ˆ</h2>
                        <p style="color: #666; font-size: 1.1em; line-height: 1.8;">
                            ğŸ‘ˆ ç‚¹å‡»å·¦ä¾§çš„å†…å­˜åŒºåŸŸ,æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯å’Œç¤ºä¾‹ä»£ç 
                        </p>

                        <div class="memory-diagram" style="margin-top: 30px;">
                            <h3 style="margin-bottom: 20px; text-align: center;">å†…å­˜åŒºåŸŸåˆ†ç±»</h3>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                                <div style="background: #e3f2fd; padding: 20px; border-radius: 10px;">
                                    <h4 style="color: #1976d2; margin-bottom: 15px;">ğŸ”„ çº¿ç¨‹å…±äº«</h4>
                                    <div class="detail-item" style="margin-bottom: 10px;">å † (Heap)</div>
                                    <div class="detail-item">æ–¹æ³•åŒº (Method Area)</div></div>
                                <div style="background: #fff3e0; padding: 20px; border-radius: 10px;">
                                    <h4 style="color: #f57c00; margin-bottom: 15px;">ğŸ‘¤ çº¿ç¨‹ç§æœ‰</h4>
                                    <div class="detail-item" style="margin-bottom: 10px;">è™šæ‹Ÿæœºæ ˆ (VM Stack)</div>
                                    <div class="detail-item" style="margin-bottom: 10px;">ç¨‹åºè®¡æ•°å™¨ (PC Register)</div>
                                    <div class="detail-item">æœ¬åœ°æ–¹æ³•æ ˆ (Native Stack)</div></div></div></div></div></div></div></div>
    </div>

    <script>
        let currentArea = null;
        let demoInterval = null;

        function showDetail(area) {
            // ç§»é™¤æ‰€æœ‰activeç±»
            document.querySelectorAll('.memory-area').forEach(el => {
                el.classList.remove('active');
            });
            document.querySelectorAll('.detail-content').forEach(el => {
                el.classList.remove('active');
            });

            // æ·»åŠ activeç±»
            document.querySelector(`[data-area="${area}"]`).classList.add('active');
            const detailElement = document.getElementById(`${area}-detail`);
            if (detailElement) {
                detailElement.classList.add('active');
                detailElement.classList.add('animate__animated', 'animate__fadeIn');
            }

            currentArea = area;
        }

        function startDemo() {
            const areas = ['heap', 'stack', 'method', 'pc', 'native'];
            let index = 0;

            clearInterval(demoInterval);

            demoInterval = setInterval(() => {
                showDetail(areas[index]);
                index = (index + 1) % areas.length;
            }, 4000);

            // ç«‹å³æ˜¾ç¤ºç¬¬ä¸€ä¸ª
            showDetail(areas[0]);
        }

        function resetDemo() {
            clearInterval(demoInterval);
            document.querySelectorAll('.memory-area').forEach(el => {
                el.classList.remove('active');
            });
            document.querySelectorAll('.detail-content').forEach(el => {
                el.classList.remove('active');
            });
            document.getElementById('default-detail').classList.add('active');
            currentArea = null;
        }

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨å¼€å§‹æ¼”ç¤º
        window.addEventListener('load', () => {
            setTimeout(() => {
                startDemo();
            }, 500);
        });
    </script>
</body>
</html>